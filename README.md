# Wildfire Suppression

This repository contains all the source code and data related to my Master's dissertation, which is available [here](). The following sections explain how to compile the codebase, generate instances, run algorithms on the generated instances, and visualize the obtained solutions. 

Contents:
1. [Generating an instance](#instances)
2. [Running an algorithm](#execution)
3. [Visualizing a solution](#visualizing)
4. [How to cite](#citing)

## Compiling the code <a name="compilation"></a>

To compile this codebase, you'll need:
- CMake 3.5 or higher
- Boost 1.7 or higher
- Gurobi 10.0.3 or higher  
- A compiler that supports C++20

Once everything is in place, type the following in your terminal from the root of this repository:
```bash
cmake -B build -S . -D CMAKE_BUILD_TYPE=Release
cmake --build build
```

## Generating an instance <a name="instances"></a>

The folder ```scripts``` contains some useful python scripts, which depend on the packages listed in ```environment.yml```.  If you have [Miniconda](https://www.anaconda.com/docs/getting-started/miniconda/install#linux) installed, type the following in your terminal from the root of this repository: 

```bash
conda env create -f environment.yml
conda activate wildfire
```

Instances to the problem are generated by the script ```instance_generation.py```, which implements the instance model described in my dissertation. To generate a 30x30 grid with light wind and moderate slope, for example, type the following:

```bash
python3 scripts/instance_generation.py --grid Medium --wind Light --slope Moderate --seed 10 --save_as_gif
```

If everything went fine, a JSON file describing the instance should have been created. The flag ```--save_as_gif``` generates a GIF illustrating how fire propagates through the grid.

<center>
 <img src='assets/Medium_Moderate_Light_10.gif' width='50%' />
</center>


## Running an algorithm <a name="execution"></a>

Four algorithms are implemented in ```src/algorithm```, namely
- Iterated Beam Search (```ibs```)
- Mixed-integer Programming (```mip```)
- Cut-based Heuristic (```cuth```)
- Random Search (```rs```)

If the codebase was compiled correctly in Section TBD, you can run beam search on the instance generated in the last section as follows:
```bash
./build/fire --alg ibs --instance Medium_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10.json --seed 1 --timelimit 300 --save_solution --output stats.csv
```

After 300 seconds, a file ```stats.csv``` should have been created with statistics about the execution, such as the objective value of the best found solution, the number of completed iterations, etc. The format of the output depends on the algorithm, and we encourage the user to check the method ```Algorithm::write_statistics()``` (which is implemented by all algorithms) for more information. 

The flag ```--save_solution``` generates a JSON file describing the best solution found by the algorithm during the 300 seconds of execution. This file is named as ```sol_${instance_name}_${seed}.json```, where ```${instance_name}``` is the name of the instance and ```${seed}``` is the seed value used by the algorithm. In the example above, ```${instance_name} = Medium_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10``` and ```${seed} = 1```. 

We will see how to visualize solutions in the next section.

## Visualizing a solution <a name="visualization"></a>

The script ```visualize_solution.py``` creates visualizations of a solution. It takes as input an instance and the JSON file generated by the flag ```save_solution```. 

There are two visualization modes. The static mode depicts the state of the grid at the optimization horizon. The ignition cell is depicted in red, burned cells are painted in orange, protected cells in black, and saved cells in white. Run the following line in your terminal to create a static visualization of the solution produced in the last section.

```bash
python3 scripts/visualize_solution.py --instance_path Small_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10.json --solution_path sol_ibs_Small_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10_1.json --mode static
```

The figure below illustrates the best solution found by beam search within 300 seconds. 

<center>
 <img src='assets/sol_ibs_Medium_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10_1.png' width='50%' />
</center>

The script also supports a dynamic visualization mode, in which the grid is represented in three-dimensional space and a slider allows you to move forward/backward in time. To run a dynamic visualization on the solution from Section, type the following:

```bash
python3 scripts/visualize_solution.py --instance_path Small_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10.json --solution_path sol_ibs_Small_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10_1.json --mode dynamic
```

The GIF below illustrates the visualization. At any time point, the ignition cell is painted in black, cells reached by the fire are painted in red, protected cells are painted in blue, and the remaining cells are painted in red.

<center>
 <img src='assets/sol_ibs_Medium_Moderate_Light_High_Moderate_Moderate_Early_VeryLate_10_1.gif' width='50%' />
</center>

## How to cite <a name="citing"></a>

TBD.